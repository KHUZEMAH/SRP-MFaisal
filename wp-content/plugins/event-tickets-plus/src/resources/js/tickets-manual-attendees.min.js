tribe.tickets=tribe.tickets||{},tribe.dialogs=tribe.dialogs||{},tribe.dialogs.events=tribe.dialogs.events||{},tribe.tickets.manualAttendees={},function(e,t){const n=e(document);t.selectors={modalWrapper:".tribe-modal__wrapper--manual-attendees",modalTitle:".tribe-modal__title",modalContent:".tribe-modal__content",formAddAttendeeTicketSelect:".tribe-tickets__manual-attendees-add-attendee-ticket-select",form:".tribe-tickets__manual-attendees-form",formFieldName:".tribe-tickets__manual-attendees-form-field-name",formFieldEmail:".tribe-tickets__manual-attendees-form-field-email",formFieldEmailResend:".tribe-tickets__manual-attendees-resend-email",formFieldEmailResendCheckbox:".tribe-tickets__manual-attendees-resend-email-input",hiddenElement:".tribe-common-a11y-hidden",validationNotice:".tribe-tickets__notice--error"},t.attendeeTicketEmail="",t.modalClose=function(n,i){const a=e(i).find(t.selectors.modalContent);t.unbindModalEvents(a)},t.bindModalClose=function(){e(tribe.dialogs.events).on("tribeDialogCloseManualAttendeesModal.tribeTickets",t.modalClose)},t.unbindModalEvents=function(e){e.find(t.selectors.formFieldEmail).off(),e.off("afterAjaxSuccess.tribeTicketsAdmin",t.bindModalEvents),e.off()},t.bindAddAttendeeTicketSelectChange=function(e,n){e.find(t.selectors.formAddAttendeeTicketSelect).on("change",function(){const t={action:"tribe_tickets_admin_manager",request:n.request,attendeeId:n.attendeeId,eventId:n.eventId,ticketId:this.value,provider:n.provider};tribe.tickets.admin.manager.request(t,e)})},t.bindModalEvents=function(e,n,i){const a=e.data.container,d=e.data.requestData;t.bindAddAttendeeTicketSelectChange(a,d),t.bindEmailEvents(a),t.bindForm(a)},t.handleFormSuccess=function(e,t,n){"submit"===e.data.requestData.step&&setTimeout(function(){location.reload()},3e3)},t.handleFormSubmission=function(n){n.preventDefault();const i=e(this),a=i.closest(t.selectors.modalContent),d=a.find(t.selectors.validationNotice),o=i.serializeArray(),s=i.data("attendee-id")||null,l={action:"tribe_tickets_admin_manager",request:s?"tribe_tickets_manual_attendees_edit":"tribe_tickets_manual_attendees_add",attendeeId:s,eventId:i.data("event-id")||null,ticketId:i.data("ticket-id")||null,provider:i.data("provider")||null,step:"submit"};if(e(o).each(function(e,t){l[t.name]=t.value}),!tribe.tickets.meta.validateAttendeeTicket(a))return d.show(),void document.getElementById(t.selectors.form.className()).scrollIntoView({behavior:"smooth",block:"start"});d.hide(),tribe.tickets.admin.manager.request(l,a),a.on("afterAjaxSuccess.tribeTicketsAdmin",{container:a,requestData:l},t.handleFormSuccess)},t.bindForm=function(n){n.find(t.selectors.form).each(function(n,i){e(i).on("submit",t.handleFormSubmission)})},t.bindEmailEvents=function(e){const n=e.find(t.selectors.formFieldEmail);t.attendeeTicketEmail=e.find(t.selectors.formFieldEmail).val()||"",n.on("input",t.handleEmailChangeCheck)},t.handleEmailChangeCheck=function(n){const i=e(n.target);t.attendeeTicketEmail.trim().toLowerCase()!==i.val().trim().toLowerCase()?t.emailReSendCheckboxShow(i):t.emailReSendCheckboxHide(i)},t.emailReSendCheckboxShow=function(e){const n=e.closest(t.selectors.form).find(t.selectors.formFieldEmailResend);n.find(t.selectors.formFieldEmailResendCheckbox).prop("checked",!0),n.removeClass(t.selectors.hiddenElement.className())},t.emailReSendCheckboxHide=function(e){const n=e.closest(t.selectors.form).find(t.selectors.formFieldEmailResend);n.find(t.selectors.formFieldEmailResendCheckbox).prop("checked",!1),n.addClass(t.selectors.hiddenElement.className())},t.modalOpen=function(n,i,a){const d=e(i),o=e(a.target).closest("button"),s=o.data("modal-title"),l=o.data("attendee-id")||null,r=o.data("event-id")||null,c=o.data("ticket-id")||null,m=o.data("provider")||null,u=l?"tribe_tickets_manual_attendees_edit":"tribe_tickets_manual_attendees_add";if(s){d.find(t.selectors.modalTitle).html(s)}const b=d.find(t.selectors.modalContent),f={action:"tribe_tickets_admin_manager",request:u,attendeeId:l,eventId:r,ticketId:c,provider:m};tribe.tickets.admin.manager.request(f,b),b.on("afterAjaxSuccess.tribeTicketsAdmin",{container:b,requestData:f},t.bindModalEvents)},t.bindModalOpen=function(){e(tribe.dialogs.events).on("tribeDialogShowManualAttendeesModal.tribeTickets",t.modalOpen)},t.ready=function(){t.bindModalOpen(),t.bindModalClose()},n.ready(t.ready)}(jQuery,tribe.tickets.manualAttendees);