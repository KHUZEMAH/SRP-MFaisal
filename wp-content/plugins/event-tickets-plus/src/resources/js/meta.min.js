var tribe_event_tickets_plus=tribe_event_tickets_plus||{};tribe_event_tickets_plus.meta=tribe_event_tickets_plus.meta||{},tribe_event_tickets_plus.meta.event=tribe_event_tickets_plus.meta.event||{},function(e,t,i,n){n.selectors={field:{text:".tribe-tickets-meta-text",checkbox:".tribe-tickets-meta-checkbox",select:".tribe-tickets-meta-select",radio:".tribe-tickets-meta-radio",number:".ticket-meta-number-field"},quantity:"input.tribe-tickets-quantity",name:"input.tribe-tickets-full-name",email:"input.tribe-tickets-email",horizontal_datepicker:{container:".tribe_horizontal_datepicker__container",select:".tribe_horizontal_datepicker__container select",day:".tribe_horizontal_datepicker__day",month:".tribe_horizontal_datepicker__month",year:".tribe_horizontal_datepicker__year",value:".tribe_horizontal_datepicker__value"}},n.horizontal_datepicker={},n.init=function(){i(".tribe-list").on("click",".attendee-meta.toggle",function(){i(this).toggleClass("on").siblings(".attendee-meta-row").slideToggle()}),this.$ticket_form=i(".tribe-events-tickets").closest(".cart"),this.$ticket_form.on("change",".tribe-tickets-order_status-row select",this.event.status_changed).on("change",".quantity input, .quantity select",this.event.quantity_changed).on("keyup input",".quantity input",this.event.quantity_changed),this.$ticket_form.find('.quantity input:not([type="hidden"]), .quantity select').each(function(){n.set_quantity(i(this))}),i(".tribe-event-tickets-plus-meta-fields").on("keydown",".tribe-tickets-meta-number input",this.event.limit_number_field_typing),this.$rsvp_block=i(".tribe-block__rsvp"),this.$rsvp_block.on("change",".tribe-block__rsvp__number-input input",this.event.block_quantity_changed).on("keyup",".tribe-block__rsvp__number-input input",this.event.block_quantity_changed),this.horizontal_datepicker.populateSelects()},n.render_fields=function(e,t){const r=i(".tribe-event-tickets-plus-meta").filter('[data-ticket-id="'+e+'"]'),a=r.find(".tribe-event-tickets-plus-meta-fields-tpl"),s=r.find(".tribe-event-tickets-plus-meta-fields"),o=a.html();if(!n.has_meta_fields(e))return;const c=s.find(".tribe-event-tickets-plus-meta-attendee").length;let l=0;if(c>t)return l=c-t,void s.find(".tribe-event-tickets-plus-meta-attendee:nth-last-child(-n+"+l+")").remove();l=t-c;let d=0;for(;d<l;d++){let t=o;t=(t=o.replace(/tribe-tickets-meta\[\]/g,"tribe-tickets-meta["+e+"]["+(c+d)+"]")).replace(/tribe-tickets-meta_([a-z0-9-]+)_/g,"tribe-tickets-meta_$1_"+(c+d)+"_"),s.append(t)}},n.set_quantity=function(e){if("yes"===e.closest("form").find(".tribe-tickets-order_status-row select").val()){const t=parseInt(e.val(),10),i=parseInt(e.closest("td").data("product-id"),10);n.render_fields(i,t)}},n.block_set_quantity=function(e,t){const i=t?parseInt(e.val(),10):0,r=parseInt(e.closest("form").data("product-id"),10);n.render_fields(r,i)},n.has_meta_fields=function(e){const n=i(t.getElementById("tribe-event-tickets-plus-meta-fields-tpl-"+e)).html();return!!i(n).find(".tribe-tickets-meta").length},n.validate_meta=function(e){let t=!0;return e.find(".tribe-tickets-meta-required").each(function(){const e=i(this);let r="";null!==(r=e.is(n.selectors.field.radio)||e.is(n.selectors.field.checkbox)?e.find("input:checked").length?"checked":"":e.is(n.selectors.field.select)?e.find("select").val():e.is(n.selectors.horizontal_datepicker.day)||e.is(n.selectors.horizontal_datepicker.month)||e.is(n.selectors.horizontal_datepicker.year)?e.val():e.find("input, textarea").val().trim())&&0!==r.length||(t=!1)}),t},n.event.quantity_changed=function(){n.set_quantity(i(this))},n.event.status_changed=function(){const e=n.$ticket_form.find(".quantity"),t="yes"===i(this).val(),r=parseInt(e.data("product-id"),10),a=t?parseInt(e.find(".tribe-tickets-quantity").val(),10):0;n.render_fields(r,a)},n.event.block_quantity_changed=function(){const e=n.$rsvp_block.find(".tribe-block__rsvp__status .tribe-active").hasClass("tribe-block__rsvp__status-button--going");n.block_set_quantity(i(this),e)},n.event.limit_number_field_typing=function(e){-1!==i.inArray(e.keyCode,[46,8,9,27,13,110])||65===e.keyCode&&(!0===e.ctrlKey||!0===e.metaKey)||67===e.keyCode&&!0===e.ctrlKey||86===e.keyCode&&!0===e.ctrlKey||88===e.keyCode&&!0===e.ctrlKey||e.keyCode>=35&&e.keyCode<=40||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()},n.horizontal_datepicker.populateSelects=function(){i(n.selectors.horizontal_datepicker.container).each(function(e,t){const r=i(t),a=r.find(n.selectors.horizontal_datepicker.day),s=r.find(n.selectors.horizontal_datepicker.month),o=r.find(n.selectors.horizontal_datepicker.year),c=r.find(n.selectors.horizontal_datepicker.value).val().split("-");3===c.length&&(o.val(c[0]),s.val(c[1]),a.val(c[2]))})},n.horizontal_datepicker.populateHiddenValue=function(e){const t=i(e.target).closest(n.selectors.horizontal_datepicker.container),r=t.find(n.selectors.horizontal_datepicker.day),a=t.find(n.selectors.horizontal_datepicker.month),s=t.find(n.selectors.horizontal_datepicker.year),o=t.find(n.selectors.horizontal_datepicker.value);o.val(s.val()+"-"+a.val()+"-"+r.val()),o.trigger("change")},n.horizontal_datepicker.makeDayMonthYearRequired=function(e){const t=i(e.target),r=t.closest(n.selectors.horizontal_datepicker.container),a=!(""===t.val()||"null-null-null"===t.val());r.find(n.selectors.horizontal_datepicker.day).prop("required",a),r.find(n.selectors.horizontal_datepicker.month).prop("required",a),r.find(n.selectors.horizontal_datepicker.year).prop("required",a),a?(r.find(n.selectors.horizontal_datepicker.day).addClass("tribe-tickets-meta-required"),r.find(n.selectors.horizontal_datepicker.month).addClass("tribe-tickets-meta-required"),r.find(n.selectors.horizontal_datepicker.year).addClass("tribe-tickets-meta-required")):(r.find(n.selectors.horizontal_datepicker.day).removeClass("tribe-tickets-meta-required"),r.find(n.selectors.horizontal_datepicker.month).removeClass("tribe-tickets-meta-required"),r.find(n.selectors.horizontal_datepicker.year).removeClass("tribe-tickets-meta-required"))},n.horizontal_datepicker.ensurePositiveNumber=function(e){const t=i(e.target),n=parseInt(t.val(),10),r=Math.abs(n);n!==r&&t.val(r)},n.addListeners=function(){i(t).on("change",n.selectors.horizontal_datepicker.select,this.horizontal_datepicker.populateHiddenValue),i(t).on("change",n.selectors.field.number,this.horizontal_datepicker.ensurePositiveNumber),i(t).on("change",n.selectors.horizontal_datepicker.value,this.horizontal_datepicker.makeDayMonthYearRequired),i(e).on("tribe_et_after_form_prefills",this.horizontal_datepicker.populateSelects)},i(function(){n.init(),n.addListeners()})}(window,document,jQuery,tribe_event_tickets_plus.meta);